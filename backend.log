INFO:     Will watch for changes in these directories: ['/Users/dl/code/pattern-factory']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [2326] using WatchFiles
INFO:pattern-factory.api:ğŸ“¦ Loading Pattern Factory API (clean version)
INFO:pattern-factory.api:ğŸ§  Imported Pitboss Supervisor successfully
INFO:pattern-factory.api:
==========================================
ğŸ”¥ Pattern Factory API Ready
ğŸ˜ Database: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
ğŸ”‘ OpenAI key prefix: sk-proj-
ğŸ“¡ WebSocket: /ws
ğŸ” Query: /query/{table}
ğŸ“š Patterns: /patterns
==========================================

INFO:     Started server process [2399]
INFO:     Waiting for application startup.
INFO:pattern-factory.api:ğŸ˜ Connecting to Postgres: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
INFO:pattern-factory.api:âœ… Postgres connected and system_log ready
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
INFO:pattern-factory.api:ğŸ§  OpenAI models: gpt-4-0613, gpt-4, gpt-3.5-turbo
INFO:     Application startup complete.
INFO:     127.0.0.1:56101 - "GET /threats HTTP/1.1" 200 OK
INFO:     127.0.0.1:56106 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56106 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56108 - "PUT /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56139 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56139 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56142 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56142 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56148 - "PUT /threats/3 HTTP/1.1" 422 Unprocessable Content
INFO:     127.0.0.1:56148 - "PUT /threats/3 HTTP/1.1" 422 Unprocessable Content
INFO:     127.0.0.1:56148 - "PUT /threats/3 HTTP/1.1" 422 Unprocessable Content
INFO:     127.0.0.1:56601 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56601 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56667 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56667 - "GET /cards HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'backend/services/api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:pattern-factory.api:ğŸ§¹ Closed Postgres pool
INFO:     Application shutdown complete.
INFO:     Finished server process [2399]
INFO:pattern-factory.api:ğŸ“¦ Loading Pattern Factory API (clean version)
INFO:pattern-factory.api:ğŸ§  Imported Pitboss Supervisor successfully
INFO:pattern-factory.api:
==========================================
ğŸ”¥ Pattern Factory API Ready
ğŸ˜ Database: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
ğŸ”‘ OpenAI key prefix: sk-proj-
ğŸ“¡ WebSocket: /ws
ğŸ” Query: /query/{table}
ğŸ“š Patterns: /patterns
==========================================

INFO:     Started server process [3187]
INFO:     Waiting for application startup.
INFO:pattern-factory.api:ğŸ˜ Connecting to Postgres: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
INFO:pattern-factory.api:âœ… Postgres connected and system_log ready
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
INFO:pattern-factory.api:ğŸ§  OpenAI models: gpt-4-0613, gpt-4, gpt-3.5-turbo
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'backend/services/api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:pattern-factory.api:ğŸ§¹ Closed Postgres pool
INFO:     Application shutdown complete.
INFO:     Finished server process [3187]
INFO:pattern-factory.api:ğŸ“¦ Loading Pattern Factory API (clean version)
INFO:pattern-factory.api:ğŸ§  Imported Pitboss Supervisor successfully
INFO:pattern-factory.api:
==========================================
ğŸ”¥ Pattern Factory API Ready
ğŸ˜ Database: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
ğŸ”‘ OpenAI key prefix: sk-proj-
ğŸ“¡ WebSocket: /ws
ğŸ” Query: /query/{table}
ğŸ“š Patterns: /patterns
==========================================

INFO:     Started server process [3301]
INFO:     Waiting for application startup.
INFO:pattern-factory.api:ğŸ˜ Connecting to Postgres: postgresql://pattern_factory:314159@127.0.0.1:5432/pattern-factory
INFO:pattern-factory.api:âœ… Postgres connected and system_log ready
INFO:httpx:HTTP Request: GET https://api.openai.com/v1/models "HTTP/1.1 200 OK"
INFO:pattern-factory.api:ğŸ§  OpenAI models: gpt-4-0613, gpt-4, gpt-3.5-turbo
INFO:     Application startup complete.
INFO:     127.0.0.1:56864 - "WebSocket /ws" [accepted]
INFO:pattern-factory.api:ğŸ”Œ WebSocket connected
INFO:backend.pitboss.config:Configuration loaded: model=gpt-4o, temperature=0.2
INFO:backend.pitboss.context_builder:âœ… Loaded Pattern Factory DSL: /Users/dl/code/pattern-factory/prompts/rules/pattern-factory.yaml
INFO:backend.pitboss.context_builder:   SYSTEM sections: rev, date, author, prompt
INFO:backend.pitboss.context_builder:   DATA tables: 33
INFO:backend.pitboss.context_builder:   Predefined RULES: 12
INFO:backend.pitboss.context_builder:[ContextBuilder] Initial YAML mtime cached: 1768246290.9347827
INFO:backend.pitboss.tools:Registered tool: sql_pitboss
INFO:backend.pitboss.tools:Registered tool: data_table
INFO:backend.pitboss.tools:Registered tool: register_view
INFO:backend.pitboss.tools:Registered tool: execute_upsert
INFO:backend.pitboss.workflow:âœ… Loaded 2 workflows (RULE, CONTENT)
INFO:backend.pitboss.workflow:ğŸ”„ Workflow Engine initialized
INFO:backend.pitboss.supervisor:ğŸ§  Pitboss Supervisor initialized
INFO:pattern-factory.api:ğŸ§  Pitboss instance created for WebSocket
INFO:     connection open
[ContextBuilder] Initial YAML mtime cached: 1768246290.9347827
INFO:     127.0.0.1:56862 - "GET /query/views_registry HTTP/1.1" 200 OK
INFO:     127.0.0.1:56866 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56866 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56873 - "PUT /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56880 - "GET /threats HTTP/1.1" 200 OK
INFO:     127.0.0.1:56883 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56883 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56893 - "OPTIONS /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56893 - "PUT /threats/3 HTTP/1.1" 200 OK
INFO:pattern-factory.api:ğŸ”Œ WebSocket disconnected
INFO:     connection closed
INFO:     127.0.0.1:56904 - "WebSocket /ws" [accepted]
INFO:pattern-factory.api:ğŸ”Œ WebSocket connected
INFO:backend.pitboss.context_builder:âœ… Loaded Pattern Factory DSL: /Users/dl/code/pattern-factory/prompts/rules/pattern-factory.yaml
INFO:backend.pitboss.context_builder:   SYSTEM sections: rev, date, author, prompt
INFO:backend.pitboss.context_builder:   DATA tables: 33
INFO:backend.pitboss.context_builder:   Predefined RULES: 12
INFO:backend.pitboss.context_builder:[ContextBuilder] Initial YAML mtime cached: 1768246290.9347827
INFO:backend.pitboss.tools:Registered tool: sql_pitboss
INFO:backend.pitboss.tools:Registered tool: data_table
INFO:backend.pitboss.tools:Registered tool: register_view
INFO:backend.pitboss.tools:Registered tool: execute_upsert
INFO:backend.pitboss.workflow:âœ… Loaded 2 workflows (RULE, CONTENT)
INFO:backend.pitboss.workflow:ğŸ”„ Workflow Engine initialized
INFO:backend.pitboss.supervisor:ğŸ§  Pitboss Supervisor initialized
INFO:pattern-factory.api:ğŸ§  Pitboss instance created for WebSocket
INFO:     connection open
[ContextBuilder] Initial YAML mtime cached: 1768246290.9347827
INFO:     127.0.0.1:56895 - "GET /query/views_registry HTTP/1.1" 200 OK
INFO:     127.0.0.1:56905 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56905 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56933 - "PUT /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56937 - "GET /threats HTTP/1.1" 200 OK
INFO:     127.0.0.1:56939 - "GET /threats/3 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56939 - "GET /cards HTTP/1.1" 200 OK
INFO:     127.0.0.1:56944 - "GET /threats HTTP/1.1" 200 OK
