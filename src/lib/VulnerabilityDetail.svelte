<script lang="ts">
	import EntityDetailLayout from './EntityDetailLayout.svelte';
	import CheckboxField from './CheckboxField.svelte';

	export let vulnerability: any = null;
	export let loading = false;
	export let error: string | null = null;
	export let saveError: string | null = null;
	export let isSaving = false;
	export let isEditing = false;
	export let onEdit: (() => void) | null = null;
	export let onCancel: (() => void) | null = null;
	export let onSave: ((e: Event) => void) | null = null;
</script>

<EntityDetailLayout
	{loading}
	{error}
	{isEditing}
	entityName="Vulnerability"
	pageTitle="Vulnerability Library"
	entity={vulnerability}
	{saveError}
	{isSaving}
	{onEdit}
	{onCancel}
	{onSave}
>
	<div slot="content">
		{#if isEditing}
			<div class="detail-section">
				<h3>Basic Information</h3>
				<div class="detail-row">
					<div class="detail-field">
						<label>Tag</label>
						<p>V{vulnerability.id}</p>
					</div>
					<div class="detail-field">
						<label>Version</label>
						<p>{vulnerability.version || '-'}</p>
					</div>
				</div>
				<div class="detail-row">
					<div class="detail-field">
						<label>Name</label>
						<div class="input">
							<input
								id="vulnerability-name"
								type="text"
								bind:value={vulnerability.name}
								class="input__text"
								class:input__text_changed={vulnerability.name?.length > 0}
								required
							/>
						</div>
					</div>
				</div>
			</div>

			<div class="detail-section">
				<h3>Details</h3>
				<div class="detail-row">
					<div class="detail-field full">
						<label>Description</label>
						<div class="input">
							<input
								id="vulnerability-description"
								type="text"
								bind:value={vulnerability.description}
								class="input__text"
								class:input__text_changed={vulnerability.description?.length > 0}
								required
							/>
						</div>
					</div>
				</div>
				<div style="margin-bottom: 0;">
					<CheckboxField
						id="vulnerability-disabled"
						bind:checked={vulnerability.disabled}
						label="Disable"
						description="When checked, this vulnerability will not be included in the risk model"
					/>
				</div>
			</div>
		{:else}
			<div class="detail-section">
				<h3>Basic Information</h3>
				<div class="detail-row">
					<div class="detail-field">
						<label>Tag</label>
						<p>V{vulnerability.id}</p>
					</div>
					<div class="detail-field">
						<label>Version</label>
						<p>{vulnerability.version || '-'}</p>
					</div>
				</div>
				<div class="detail-row">
					<div class="detail-field">
						<label>Name</label>
						<p>{vulnerability.name}</p>
					</div>
				</div>
			</div>

			<div class="detail-section">
				<h3>Details</h3>
				<div class="detail-row">
					<div class="detail-field full">
						<label>Description</label>
						<p>{vulnerability.description || '-'}</p>
					</div>
				</div>
				<div class="detail-row">
					<div class="detail-field">
						<label>Disabled</label>
						<p>{vulnerability.disabled ? 'Yes' : 'No'}</p>
					</div>
				</div>
			</div>
		{/if}
	</div>
</EntityDetailLayout>
